<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>editor</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" type="text/css" media="screen" href="../style.css" />
    <script src="../main.js"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />

    <!--Internal CSS start-->
    <style>
      h1 {
        padding-top: 40px;
        padding-bottom: 40px;
        text-align: center;
        color: #957dad;
        font-family: "Montserrat", sans-serif;
      }

      section {
        padding: 5%;
        padding-top: 0;
      }

      button:hover {
        background-color: #fec8d8 !important;
      }

      #textarea1 {
        padding: 3%;
        border-color: #957dad;
        border-width: thick;
      }

      .flex-box {
        display: flex;
        justify-content: center;
      }

.material-symbols-rounded {
  line-height: normal;
  font-variation-settings:
  'FILL' 0,
  'wght' 400,
  'GRAD' 0,
  'opsz' 24
    }
    </style>
  </head>
  <body>
    <section class="">
      <h1 class="shadow-sm">TEXT EDITOR</h1>
      <div class="flex-box">
        <div class="row">
          <div class="col">
            <button type="button" onclick="bold()" class="shadow-sm btn btn-outline-secondary" data-toggle="tooltip" data-placement="top" title="Bold Text">
              <span class="material-symbols-rounded">format_bold</span>
            </button>
            <button type="button" onclick="f2()" class="shadow-sm btn btn-outline-success" data-toggle="tooltip" data-placement="top" title="Italic Text" >
              <span class="material-symbols-rounded">format_italic</span>
            </button> <button type="button" onclick="f3()" class="shadow-sm btn btn-outline-primary" data-toggle="tooltip" data-placement="top" title="Left Align" >
              <span class="material-symbols-rounded">format_underlined</span>
            </button>
            <button type="button" onclick="f4()" class="btn shadow-sm btn-outline-secondary" data-toggle="tooltip" data-placement="top" title="Center Align" >
              <span class="material-symbols-rounded">format_align_center</span>
            </button>
            <button type="button" onclick="f5()" class="btn shadow-sm btn-outline-primary" data-toggle="tooltip" data-placement="top" title="Right Align" >
              <span class="material-symbols-rounded">format_align_right</span>
            </button>
            <button type="button" onclick="f6()" class="btn shadow-sm btn-outline-secondary" data-toggle="tooltip" data-placement="top" title="Uppercase Text" >
              <span class="material-symbols-rounded">uppercase</span>
            </button>
            <button type="button" onclick="f7()" class="btn shadow-sm btn-outline-primary" data-toggle="tooltip" data-placement="top" title="Lowercase Text" >
              <span class="material-symbols-rounded">lowercase</span>
            </button>
            <button type="button" onclick="f8()" class="btn shadow-sm btn-outline-primary" data-toggle="tooltip" data-placement="top" title="Capitalize Text" >
              Capitalize
            </button>
          </div>
        </div>
      </div>
      <br />
      <div class="row">
        <div class="col-md-3 col-sm-3"></div>
        <div class="col-md-6 col-sm-9">
          <input id="headline" type="text" class="input shadow">
          <div contenteditable id="conteudo" class="input shadow"></div>
          <form id="forms" method="post" class="flex-box">
            <input type="submit" value="Publish" />
          </form>
        </div>
        <div class="col-md-3"></div>
      </div>
    </section>
    <script>
      document.getElementById('forms').addEventListener('submit', function(event) {
        event.preventDefault();
        const headline = document.getElementById("headline").value.trim();
        const contentRaw = document.getElementById("conteudo");
    var arrayIH = [];

    if (!headline) return;

    contentRaw.innerHTML = contentRaw.innerHTML.replace(/<br>/g, "").replace(/&nbsp;/g, "");

    if (contentRaw.childElementCount > 0) {
      for (const element of contentRaw.children) {
          arrayIH.push(element.innerHTML.trim());
      }
      var content = JSON.stringify(arrayIH);
    }
    else {
      var content = contentRaw.innerHTML.trim();
    }

    console.log(headline);
    console.log(encodeURIComponent(headline));

    var xhr = new XMLHttpRequest();
    xhr.open('POST', '../idk.php');
    xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
    xhr.send('headline=' + encodeURIComponent(headline) + '&content=' + encodeURIComponent(content));
    xhr.onload = function() {
    if (xhr.status === 200) {
        console.log('Dados enviados com sucesso!');
        document.getElementById("headline").value = "";
        window.location.href = "../artigos/" + xhr.responseText;
    } else {
        console.log('Ocorreu um erro ao enviar os dados.');
    }
    };
    });
    </script>
  </body>
</html>
